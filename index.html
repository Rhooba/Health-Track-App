<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Health Tracker App</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/date-fns"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
  <script src="script.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>

<body>
  <h1>Health Tracker</h1>

  <!-- Entry Form -->
  <div id="entryForm">
    <input type="text" id="foodInput" placeholder="What did you eat?" />
    <input type="date" id="dateInput" placeholder="Select date" />
    
    <select id="mealTypeInput">
      <option value="" disabled selected>Meal or Drink?</option>
      <option value="Breakfast">Breakfast</option>
      <option value="Lunch">Lunch</option>
      <option value="Dinner">Dinner</option>
      <option value="Snacks">Snack</option>
      <option value="Dessert">Dessert</option>
      <option value="Drinks">Drinks</option>
    </select>

    <button id="addLogButton">Add Entry</button>

    <label class="sick-label">
      <input type="checkbox" id="sickInput" class="sick-checkbox"/>
      <span class="sick-label-text">Made me feel sick</span>
    </label>

    <button id="clearAllButton">Clear All Entries</button>
    <button id="exportEncryptedButton">ğŸ“Š Export for Health Provider</button>
  </div>

  <!-- Food Log -->
  <div id="foodLogPlaceholder" class="food-log-placeholder">
    <span class="placeholder-icon">ğŸğŸ’¾</span>
    <span class="placeholder-text">Your Saved Food Entries</span>
  </div>
  <ul id="foodLogList"></ul>

  <!-- Filters -->
  <div id="filters">
    <button id="allBtn">Show All ğŸ‘©ğŸ»â€ğŸ³</button>
    <button id="sickBtn">Only Sick ğŸ¤®</button>
    <button id="okayBtn">Only Okay ğŸ¤©</button>
  </div>

  <!-- Health Vitals Section -->
  <div class="health-vitals-section">
    <button id="logBPButton" class="vitals-btn bp-btn">ğŸ“ˆ Log BP</button>
    <button id="logBSButton" class="vitals-btn bs-btn">ğŸ”Š Log BS</button>
  </div>

  <!-- Health Details Section -->
  <div class="health-details-section">
    <button class="collapsible health-collapsible">ğŸ’ª Health Details</button>
    <div class="content health-content">
      
      <!-- Exercise Section -->
      <div class="health-category">
        <label class="health-label">Exercise Today:</label>
        <div class="radio-group">
          <label class="radio-label">
            <input type="radio" name="exercised" value="no" class="health-radio" checked>
            <span class="radio-text">No</span>
          </label>
          <label class="radio-label">
            <input type="radio" name="exercised" value="yes" class="health-radio">
            <span class="radio-text">Yes</span>
          </label>
        </div>
        <div class="text-input-container" id="exerciseInput" style="display: none;">
         <input type="text" class="health-text-field" placeholder="e.g., 30 min walk, yoga, stretching..."/>
         <small class="field-hint">Separate multiple activitties with commas</small>
        </div>
      </div>

      <!-- Stress Relief Section -->
      <div class="health-category">
        <label class="health-label">Stress Relief:</label>
        <div class="radio-group">
          <label class="radio-label">
            <input type="radio" name="stressRelief" value="no" checked> No
          </label>
          <label class="radio-label">
            <input type="radio" name="stressRelief" value="yes"> Yes
          </label>
        </div>
        <div class="text-input-container" id="stressInput" style="display: none;">
          <input type="text" class="health-text-field" placeholder="e.g., walked outside, read a book, meditated..."/>
          <small class="field-hint">Describe what you did</small>
        </div>
      </div>

      <!-- Symptoms Section -->
      <div class="health-category">
        <label class="health-label">Symptoms:</label>
        <div class="radio-group">
          <label class="radio-label">
            <input type="radio" name="symptoms" value="no" checked> No
          </label>
          <label class="radio-label">
            <input type="radio" name="symptoms" value="yes"> Yes
          </label>
        </div>
        <div class="text-input-container" id="symptomsInput" style="display: none;">
          <input type="text" class="health-text-field" placeholder="e.g., cramps, bloating, headache..."/>
          <small class="field-hint">Describe any symptoms you're experiencing</small>
        </div>
      </div>

      <!-- Save Health Details Button -->
      <div style="text-align: center; margin-top: 20px;">
        <button id="saveHealthDetailsBtn" class="notes-btn save-notes">ğŸ’¾ Save Health Details</button>
      </div>

    </div>
  </div>

    <!-- Daily Notes Section -->
  <div class="daily-notes-section">
    <button class="notes-collapsible">ğŸ“ Daily Notes</button>
    <div class="content notes-content">
      <p class="notes-description">Add notes about your day</p>
      
      <div class="notes-date-selector">
        <label for="notesDate" class="notes-label">Date:</label>
        <input type="date" id="notesDate" class="notes-date-input" />
      </div>
      
      <textarea id="dailyNotesText" class="daily-notes-textarea" 
                placeholder="Type your notes here... (e.g., felt energetic today, went for a walk, slept well, etc.)"></textarea>
      
      <div class="notes-actions">
        <button id="saveNotesBtn" class="notes-btn save-notes">ğŸ’¾ Save Notes</button>
        <button id="clearNotesBtn" class="notes-btn clear-notes">ğŸ—‘ï¸ Clear</button>
      </div>
      
      <div id="notesSavedIndicator" class="notes-saved-indicator" style="display: none;">
        âœ… Notes saved successfully!
      </div>
      
      <!-- Saved Notes List -->
      <div id="savedNotesList" class="saved-notes-list" style="margin-top: 20px;">
        <h3 class="saved-notes-title" style="display: none;">ğŸ“‹ Saved Notes</h3>
        <div id="savedNotesContainer"></div>
      </div>
    </div>
  </div>

  <!-- Favorite Foods Section -->
  <h2>Save All of Your Favorite Foods</h2>
  <div class="favorites-section">
    <button class="collapsible active">ğŸ’– Favorite Foods ğŸŒŸ</button>
    <div class="content" style="display: block;">
      <ul id="favoritesList"></ul>
    </div>
  </div>

  <!-- Graphs Section -->
  <h2>Summary Graphs for Food and BP</h2>
  
  <!-- Daily Food Combination Chart -->
  <div class="chart-section">
    <button class="collapsible">ğŸ“Š Daily Food Combinations</button>
    <div class="content">
      <p>Track your W/S/P food combinations throughout the day. Red bars indicate unsafe S+P combinations.</p>
      <canvas id="dailyCombinationChart" width="400" height="200"></canvas>
    </div>
  </div>

  <!-- AI Health Insights -->
  <div class="chart-section">
    <button class="collapsible">ğŸ¤– AI Health Insights</button>
    <div class="content">
      <div id="aiSuggestions"></div>
    </div>
  </div>

  <!-- BP Line Chart Section -->
  <div class="chart-section">
    <button class="collapsible">Â± Blood Pressure Trend</button>
    <div class="content graph-content">
      <canvas id="bpLineChart" width="400" height="200"></canvas>
    </div>
  </div>

  <!-- Welcome Greeting Popup -->
  <div id="bpReminderPopup" class="popup-overlay">
    <div class="popup-content">
      <div class="popup-header">
        <h3>ğŸ‘‹ Welcome to Health Tracker!</h3>
        <button id="closeBpPopup" class="close-btn" onclick="closePopup()">&times;</button>
      </div>
      <div class="popup-body">
        <p>ğŸ <strong>Track your food and health patterns easily!</strong></p>
        <p>â€¢ Add foods you eat and how they make you feel</p>
        <p>â€¢ Record your blood pressure for health trends</p>
        <p>â€¢ Get AI insights about your eating patterns</p>
        <br>
        <p>ğŸ’» <strong>Built with â¤ï¸ for Mom</strong></p>
        <p><a href="https://github.com/Rhooba/food-tracker-app" target="_blank" style="color: var(--tropic-blue); text-decoration: underline;">Further instructions and other projects see my GitHub â†’</a></p>
      </div>
      <div class="popup-actions">
        <button id="addBpNow" class="popup-btn primary" onclick="closePopup()">Get Started!</button>
        <button id="skipToday" class="popup-btn secondary" onclick="closePopup()">Skip Today</button>
      </div>
    </div>
  </div>

  <!-- BP Reminder Popup -->
  <div id="bpReminderOnlyPopup" class="popup-overlay">
    <div class="popup-content">
      <div class="popup-header">
        <h3>ğŸ©º Blood Pressure Reminder</h3>
        <button id="closeBpReminderOnly" class="close-btn" onclick="closePopup()">&times;</button>
      </div>
      <div class="popup-body">
        <p>ğŸ“Š <strong>You have not entered your Blood Pressure for today.</strong></p>
        <p>You've made several entries, but haven't recorded it.</p>
        <p>ğŸ’¡ <strong>Please enter your BP on your next entry</strong> to track your health trends!</p>
      </div>
      <div class="popup-actions">
        <button id="addBpNowReminder" class="popup-btn primary" onclick="closePopup()">Got it!</button>
        <button id="skipBpToday" class="popup-btn secondary" onclick="closePopup()">Skip Today</button>
      </div>
    </div>
  </div>

  <!-- Warning Modal -->
  <div id="warningModal" class="modal-overlay" style="display: none;">
    <div class="warning-modal">
      <div class="warning-header">
        <div class="warning-icon">âš ï¸</div>
        <h3 id="warningTitle">Food Combination Alert</h3>
      </div>
      <div class="warning-content">
        <p id="warningMessage" class="warning-message">
          <strong>S + P Combination Detected!</strong><br>
          This combination may cause digestive discomfort.
        </p>
        <div class="detected-items">
          <span class="detected-label">Items detected:</span>
          <span id="detectedItems" class="detected-list"></span>
        </div>
        <!-- Timer Section (shown for timing conflicts) -->
        <div id="timerSection" style="display: none; margin-top: 15px; text-align: center;">
          <p id="timerMessage" style="color: #e74c3c; font-weight: 600;">Wait until safe time:</p>
          <p id="safeTime" style="font-size: 1.2rem; font-weight: bold; color: #087E8B;"></p>
          <p id="countdownTime" style="font-size: 1.5rem; font-weight: bold; color: #e74c3c;">00:00:00</p>
        </div>
      </div>
      <div class="warning-actions">
        <button id="warningOverrideBtn" class="warning-btn override">âš ï¸ Add Anyway</button>
        <button id="warningOkBtn" class="warning-btn secondary" onclick="closeWarningModal()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- BP Modal -->
  <div id="bpModal" class="modal-overlay" style="display: none;">
    <div class="vitals-modal">
      <div class="vitals-header">
        <div class="vitals-icon">ğŸ“ˆ</div>
        <h3>Log Blood Pressure</h3>
      </div>
      <div class="vitals-content">
        <div class="bp-input-container">
          <label for="bpInput" class="vitals-label">Blood Pressure (120/80):</label>
          <input type="text" id="bpInput" class="vitals-input" placeholder="e.g. 120/80" pattern="[0-9]+/[0-9]+" />
        </div>
        <div class="datetime-container">
          <label for="bpDateTime" class="vitals-label">Date & Time:</label>
          <input type="datetime-local" id="bpDateTime" class="vitals-input" />
        </div>
      </div>
      <div class="vitals-actions">
        <button id="saveBPBtn" class="vitals-btn primary">Save</button>
        <button id="cancelBPBtn" class="vitals-btn secondary" onclick="closeBPModal()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- BS Modal -->
  <div id="bsModal" class="modal-overlay" style="display: none;">
    <div class="vitals-modal">
      <div class="vitals-header">
        <div class="vitals-icon">ğŸ”Š</div>
        <h3>Log Bowel Sounds</h3>
      </div>
      <div class="vitals-content">
        <div class="bs-input-container">
          <label for="bsInput" class="vitals-label">Bowel Sounds (1-7):</label>
          <select id="bsInput" class="vitals-select">
            <option value="">Select level...</option>
            <option value="1">1 (Very Low)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4 (Neutral)</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7 (Very High)</option>
          </select>
        </div>
        <div class="datetime-container">
          <label for="bsDateTime" class="vitals-label">Date & Time:</label>
          <input type="datetime-local" id="bsDateTime" class="vitals-input" />
        </div>
      </div>
      <div class="vitals-actions">
        <button id="saveBSBtn" class="vitals-btn primary">Save</button>
        <button id="cancelBSBtn" class="vitals-btn secondary" onclick="closeBSModal()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Edit Entry Modal -->
  <div id="editModal" class="modal-overlay" style="display: none;">
    <div class="vitals-modal edit-modal">
      <div class="vitals-header">
        <div class="vitals-icon">âœï¸</div>
        <h3>Edit Entry</h3>
      </div>
      <div class="vitals-content edit-content">
        <div class="edit-field">
          <label for="editTimestamp" class="vitals-label">Timestamp:</label>
          <input type="datetime-local" id="editTimestamp" class="vitals-input" />
        </div>
        
        <div class="edit-field">
          <label class="vitals-label">Exercise:</label>
          <input type="text" id="editExercise" class="vitals-input" placeholder="e.g., 30 min walk, yoga" />
        </div>
        
        <div class="edit-field">
          <label class="vitals-label">Stress Relief:</label>
          <input type="text" id="editStressRelief" class="vitals-input" placeholder="e.g., walked outside, read" />
        </div>
        
        <div class="edit-field">
          <label class="vitals-label">Symptoms:</label>
          <input type="text" id="editSymptoms" class="vitals-input" placeholder="e.g., cramps, bloating, headache" />
        </div>
      </div>
      <div class="vitals-actions">
        <button id="saveEditBtn" class="vitals-btn primary">Save Changes</button>
        <button id="cancelEditBtn" class="vitals-btn secondary">Cancel</button>
      </div>
    </div>
  </div>

</html>